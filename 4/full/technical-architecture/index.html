<!doctype html>
<html data-n-head-ssr>
  <head>
    <meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="application" name="application-name" content="DataFair"><meta data-n-head="ssr" data-hid="description" name="description" content="DataFair - Documentation"><title>Data Fair - Architecture technique</title><base href="/4/"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:300,400,500,700,400italic|Material+Icons"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="favicon.ico"><link data-n-head="ssr" rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Nunito:100,300,400,500,700,900&display=swap"><link data-n-head="ssr" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css"><style data-n-head="vuetify" type="text/css" id="vuetify-theme-stylesheet" nonce="undefined">.v-application a{color:#1976d2}.v-application .primary{background-color:#1976d2!important;border-color:#1976d2!important}.v-application .primary--text{color:#1976d2!important;caret-color:#1976d2!important}.v-application .primary.lighten-5{background-color:#c7fdff!important;border-color:#c7fdff!important}.v-application .primary--text.text--lighten-5{color:#c7fdff!important;caret-color:#c7fdff!important}.v-application .primary.lighten-4{background-color:#a8e0ff!important;border-color:#a8e0ff!important}.v-application .primary--text.text--lighten-4{color:#a8e0ff!important;caret-color:#a8e0ff!important}.v-application .primary.lighten-3{background-color:#8ac5ff!important;border-color:#8ac5ff!important}.v-application .primary--text.text--lighten-3{color:#8ac5ff!important;caret-color:#8ac5ff!important}.v-application .primary.lighten-2{background-color:#6aaaff!important;border-color:#6aaaff!important}.v-application .primary--text.text--lighten-2{color:#6aaaff!important;caret-color:#6aaaff!important}.v-application .primary.lighten-1{background-color:#488fef!important;border-color:#488fef!important}.v-application .primary--text.text--lighten-1{color:#488fef!important;caret-color:#488fef!important}.v-application .primary.darken-1{background-color:#005eb6!important;border-color:#005eb6!important}.v-application .primary--text.text--darken-1{color:#005eb6!important;caret-color:#005eb6!important}.v-application .primary.darken-2{background-color:#00479b!important;border-color:#00479b!important}.v-application .primary--text.text--darken-2{color:#00479b!important;caret-color:#00479b!important}.v-application .primary.darken-3{background-color:#003180!important;border-color:#003180!important}.v-application .primary--text.text--darken-3{color:#003180!important;caret-color:#003180!important}.v-application .primary.darken-4{background-color:#001e67!important;border-color:#001e67!important}.v-application .primary--text.text--darken-4{color:#001e67!important;caret-color:#001e67!important}.v-application .secondary{background-color:#424242!important;border-color:#424242!important}.v-application .secondary--text{color:#424242!important;caret-color:#424242!important}.v-application .secondary.lighten-5{background-color:#c1c1c1!important;border-color:#c1c1c1!important}.v-application .secondary--text.text--lighten-5{color:#c1c1c1!important;caret-color:#c1c1c1!important}.v-application .secondary.lighten-4{background-color:#a6a6a6!important;border-color:#a6a6a6!important}.v-application .secondary--text.text--lighten-4{color:#a6a6a6!important;caret-color:#a6a6a6!important}.v-application .secondary.lighten-3{background-color:#8b8b8b!important;border-color:#8b8b8b!important}.v-application .secondary--text.text--lighten-3{color:#8b8b8b!important;caret-color:#8b8b8b!important}.v-application .secondary.lighten-2{background-color:#727272!important;border-color:#727272!important}.v-application .secondary--text.text--lighten-2{color:#727272!important;caret-color:#727272!important}.v-application .secondary.lighten-1{background-color:#595959!important;border-color:#595959!important}.v-application .secondary--text.text--lighten-1{color:#595959!important;caret-color:#595959!important}.v-application .secondary.darken-1{background-color:#2c2c2c!important;border-color:#2c2c2c!important}.v-application .secondary--text.text--darken-1{color:#2c2c2c!important;caret-color:#2c2c2c!important}.v-application .secondary.darken-2{background-color:#171717!important;border-color:#171717!important}.v-application .secondary--text.text--darken-2{color:#171717!important;caret-color:#171717!important}.v-application .secondary.darken-3{background-color:#000!important;border-color:#000!important}.v-application .secondary--text.text--darken-3{color:#000!important;caret-color:#000!important}.v-application .secondary.darken-4{background-color:#000!important;border-color:#000!important}.v-application .secondary--text.text--darken-4{color:#000!important;caret-color:#000!important}.v-application .accent{background-color:#82b1ff!important;border-color:#82b1ff!important}.v-application .accent--text{color:#82b1ff!important;caret-color:#82b1ff!important}.v-application .accent.lighten-5{background-color:#fff!important;border-color:#fff!important}.v-application .accent--text.text--lighten-5{color:#fff!important;caret-color:#fff!important}.v-application .accent.lighten-4{background-color:#f8ffff!important;border-color:#f8ffff!important}.v-application .accent--text.text--lighten-4{color:#f8ffff!important;caret-color:#f8ffff!important}.v-application .accent.lighten-3{background-color:#daffff!important;border-color:#daffff!important}.v-application .accent--text.text--lighten-3{color:#daffff!important;caret-color:#daffff!important}.v-application .accent.lighten-2{background-color:#bce8ff!important;border-color:#bce8ff!important}.v-application .accent--text.text--lighten-2{color:#bce8ff!important;caret-color:#bce8ff!important}.v-application .accent.lighten-1{background-color:#9fccff!important;border-color:#9fccff!important}.v-application .accent--text.text--lighten-1{color:#9fccff!important;caret-color:#9fccff!important}.v-application .accent.darken-1{background-color:#6596e2!important;border-color:#6596e2!important}.v-application .accent--text.text--darken-1{color:#6596e2!important;caret-color:#6596e2!important}.v-application .accent.darken-2{background-color:#467dc6!important;border-color:#467dc6!important}.v-application .accent--text.text--darken-2{color:#467dc6!important;caret-color:#467dc6!important}.v-application .accent.darken-3{background-color:#2364aa!important;border-color:#2364aa!important}.v-application .accent--text.text--darken-3{color:#2364aa!important;caret-color:#2364aa!important}.v-application .accent.darken-4{background-color:#004c90!important;border-color:#004c90!important}.v-application .accent--text.text--darken-4{color:#004c90!important;caret-color:#004c90!important}.v-application .error{background-color:#ff5252!important;border-color:#ff5252!important}.v-application .error--text{color:#ff5252!important;caret-color:#ff5252!important}.v-application .error.lighten-5{background-color:#ffe4d5!important;border-color:#ffe4d5!important}.v-application .error--text.text--lighten-5{color:#ffe4d5!important;caret-color:#ffe4d5!important}.v-application .error.lighten-4{background-color:#ffc6b9!important;border-color:#ffc6b9!important}.v-application .error--text.text--lighten-4{color:#ffc6b9!important;caret-color:#ffc6b9!important}.v-application .error.lighten-3{background-color:#ffa99e!important;border-color:#ffa99e!important}.v-application .error--text.text--lighten-3{color:#ffa99e!important;caret-color:#ffa99e!important}.v-application .error.lighten-2{background-color:#ff8c84!important;border-color:#ff8c84!important}.v-application .error--text.text--lighten-2{color:#ff8c84!important;caret-color:#ff8c84!important}.v-application .error.lighten-1{background-color:#ff6f6a!important;border-color:#ff6f6a!important}.v-application .error--text.text--lighten-1{color:#ff6f6a!important;caret-color:#ff6f6a!important}.v-application .error.darken-1{background-color:#df323b!important;border-color:#df323b!important}.v-application .error--text.text--darken-1{color:#df323b!important;caret-color:#df323b!important}.v-application .error.darken-2{background-color:#bf0025!important;border-color:#bf0025!important}.v-application .error--text.text--darken-2{color:#bf0025!important;caret-color:#bf0025!important}.v-application .error.darken-3{background-color:#9f0010!important;border-color:#9f0010!important}.v-application .error--text.text--darken-3{color:#9f0010!important;caret-color:#9f0010!important}.v-application .error.darken-4{background-color:maroon!important;border-color:maroon!important}.v-application .error--text.text--darken-4{color:maroon!important;caret-color:maroon!important}.v-application .info{background-color:#2196f3!important;border-color:#2196f3!important}.v-application .info--text{color:#2196f3!important;caret-color:#2196f3!important}.v-application .info.lighten-5{background-color:#d4ffff!important;border-color:#d4ffff!important}.v-application .info--text.text--lighten-5{color:#d4ffff!important;caret-color:#d4ffff!important}.v-application .info.lighten-4{background-color:#b5ffff!important;border-color:#b5ffff!important}.v-application .info--text.text--lighten-4{color:#b5ffff!important;caret-color:#b5ffff!important}.v-application .info.lighten-3{background-color:#95e8ff!important;border-color:#95e8ff!important}.v-application .info--text.text--lighten-3{color:#95e8ff!important;caret-color:#95e8ff!important}.v-application .info.lighten-2{background-color:#75ccff!important;border-color:#75ccff!important}.v-application .info--text.text--lighten-2{color:#75ccff!important;caret-color:#75ccff!important}.v-application .info.lighten-1{background-color:#51b0ff!important;border-color:#51b0ff!important}.v-application .info--text.text--lighten-1{color:#51b0ff!important;caret-color:#51b0ff!important}.v-application .info.darken-1{background-color:#007cd6!important;border-color:#007cd6!important}.v-application .info--text.text--darken-1{color:#007cd6!important;caret-color:#007cd6!important}.v-application .info.darken-2{background-color:#0064ba!important;border-color:#0064ba!important}.v-application .info--text.text--darken-2{color:#0064ba!important;caret-color:#0064ba!important}.v-application .info.darken-3{background-color:#004d9f!important;border-color:#004d9f!important}.v-application .info--text.text--darken-3{color:#004d9f!important;caret-color:#004d9f!important}.v-application .info.darken-4{background-color:#003784!important;border-color:#003784!important}.v-application .info--text.text--darken-4{color:#003784!important;caret-color:#003784!important}.v-application .success{background-color:#4caf50!important;border-color:#4caf50!important}.v-application .success--text{color:#4caf50!important;caret-color:#4caf50!important}.v-application .success.lighten-5{background-color:#dcffd6!important;border-color:#dcffd6!important}.v-application .success--text.text--lighten-5{color:#dcffd6!important;caret-color:#dcffd6!important}.v-application .success.lighten-4{background-color:#beffba!important;border-color:#beffba!important}.v-application .success--text.text--lighten-4{color:#beffba!important;caret-color:#beffba!important}.v-application .success.lighten-3{background-color:#a2ff9e!important;border-color:#a2ff9e!important}.v-application .success--text.text--lighten-3{color:#a2ff9e!important;caret-color:#a2ff9e!important}.v-application .success.lighten-2{background-color:#85e783!important;border-color:#85e783!important}.v-application .success--text.text--lighten-2{color:#85e783!important;caret-color:#85e783!important}.v-application .success.lighten-1{background-color:#69cb69!important;border-color:#69cb69!important}.v-application .success--text.text--lighten-1{color:#69cb69!important;caret-color:#69cb69!important}.v-application .success.darken-1{background-color:#2d9437!important;border-color:#2d9437!important}.v-application .success--text.text--darken-1{color:#2d9437!important;caret-color:#2d9437!important}.v-application .success.darken-2{background-color:#00791e!important;border-color:#00791e!important}.v-application .success--text.text--darken-2{color:#00791e!important;caret-color:#00791e!important}.v-application .success.darken-3{background-color:#006000!important;border-color:#006000!important}.v-application .success--text.text--darken-3{color:#006000!important;caret-color:#006000!important}.v-application .success.darken-4{background-color:#004700!important;border-color:#004700!important}.v-application .success--text.text--darken-4{color:#004700!important;caret-color:#004700!important}.v-application .warning{background-color:#fb8c00!important;border-color:#fb8c00!important}.v-application .warning--text{color:#fb8c00!important;caret-color:#fb8c00!important}.v-application .warning.lighten-5{background-color:#ffff9e!important;border-color:#ffff9e!important}.v-application .warning--text.text--lighten-5{color:#ffff9e!important;caret-color:#ffff9e!important}.v-application .warning.lighten-4{background-color:#fffb82!important;border-color:#fffb82!important}.v-application .warning--text.text--lighten-4{color:#fffb82!important;caret-color:#fffb82!important}.v-application .warning.lighten-3{background-color:#ffdf67!important;border-color:#ffdf67!important}.v-application .warning--text.text--lighten-3{color:#ffdf67!important;caret-color:#ffdf67!important}.v-application .warning.lighten-2{background-color:#ffc24b!important;border-color:#ffc24b!important}.v-application .warning--text.text--lighten-2{color:#ffc24b!important;caret-color:#ffc24b!important}.v-application .warning.lighten-1{background-color:#ffa72d!important;border-color:#ffa72d!important}.v-application .warning--text.text--lighten-1{color:#ffa72d!important;caret-color:#ffa72d!important}.v-application .warning.darken-1{background-color:#db7200!important;border-color:#db7200!important}.v-application .warning--text.text--darken-1{color:#db7200!important;caret-color:#db7200!important}.v-application .warning.darken-2{background-color:#bb5900!important;border-color:#bb5900!important}.v-application .warning--text.text--darken-2{color:#bb5900!important;caret-color:#bb5900!important}.v-application .warning.darken-3{background-color:#9d4000!important;border-color:#9d4000!important}.v-application .warning--text.text--darken-3{color:#9d4000!important;caret-color:#9d4000!important}.v-application .warning.darken-4{background-color:#802700!important;border-color:#802700!important}.v-application .warning--text.text--darken-4{color:#802700!important;caret-color:#802700!important}</style><link rel="preload" href="/4/_nuxt/386a0b2.js" as="script"><link rel="preload" href="/4/_nuxt/77b2d93.js" as="script"><link rel="preload" href="/4/_nuxt/css/72346c5.css" as="style"><link rel="preload" href="/4/_nuxt/88f996d.js" as="script"><link rel="preload" href="/4/_nuxt/css/0a9a606.css" as="style"><link rel="preload" href="/4/_nuxt/61b5a06.js" as="script"><link rel="preload" href="/4/_nuxt/css/93890e4.css" as="style"><link rel="preload" href="/4/_nuxt/e5ad1e7.js" as="script"><link rel="preload" href="/4/_nuxt/css/e550689.css" as="style"><link rel="preload" href="/4/_nuxt/0f1c295.js" as="script"><link rel="stylesheet" href="/4/_nuxt/css/72346c5.css"><link rel="stylesheet" href="/4/_nuxt/css/0a9a606.css"><link rel="stylesheet" href="/4/_nuxt/css/93890e4.css"><link rel="stylesheet" href="/4/_nuxt/css/e550689.css"><link rel="preload" href="/4/_nuxt/static/1726145075/full/technical-architecture/state.js" as="script"><link rel="preload" href="/4/_nuxt/static/1726145075/full/technical-architecture/payload.js" as="script"><link rel="preload" href="/4/_nuxt/static/1726145075/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div data-app="true" id="app" class="v-application v-application--is-ltr theme--light"><div class="v-application--wrap"><main class="v-main" style="padding-top:0;padding-right:0;padding-bottom:0;padding-left:0"><div class="v-main__wrap"><div class="full-chapter"><div class="mt-6 pt-6 text-center col"><div class="v-image v-responsive my-6 theme--light" style="height:160px"><div class="v-image__image v-image__image--preload v-image__image--contain" style="background-position:center center"></div><div class="v-responsive__content"></div></div> <h1 class="text-h3 grey--text text--darken-3">
      Data Fair
    </h1> <h4>
      Version 4.16.0
    </h4> <h1 class="text-h3 grey--text text--darken-3" style="margin-top:200px">Architecture technique</h1> <h4 style="margin-top:200px!important">
      12 septembre 2024<br></h4></div> <div class="page-break"></div> <div class="row mt-4 justify-center"><div><h2 class="text-h4 my-4 grey--text text--darken-3">Table des matières</h2> <h4><a href="#introduction">1 - Introduction</a> <!----></h4><h4><a href="#data-fair">2 - Data Fair</a> <!----></h4><h4><a href="#simple-directory">3 - Simple Directory</a> <!----></h4><h4><a href="#portal">4 - Data Fair Portal</a> <!----></h4><h4><a href="#connectors">5 - Connecteurs de catalogues</a> <!----></h4><h4><a href="#processings">6 - Data Fair Processings</a> <!----></h4><h4><a href="#notify">7 - Notify</a> <!----></h4><h4><a href="#analytics">8 - Analytics</a> <!----></h4><h4><a href="#capture">9 - Capture</a> <!----></h4><h4><a href="#thumbor">10 - Thumbor</a> <!----></h4><h4><a href="#backup">11 - Backup</a> <!----></h4><h4><a href="#http-log">12 - Statistiques d'API</a> <!----></h4></div></div> <div class="page-break"></div> <h2 id="introduction" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      1 - Introduction
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>L'architecture technique retenue est une plateforme composée de différents services web. La plupart de ces services sont open source et décrits ici, mais certaines extensions peuvent être disponibles sous la forme de services distants propriétaires :</p>
<ul>
<li><strong>Data Fair</strong>, le coeur de la solution : indexer, « APIfier », enrichir et partager facilement ses données ;</li>
<li><strong>Simple Directory</strong> : se connecter au portail et gérer les comptes ;</li>
<li><strong>Data Fair Portal</strong> : créer facilement plusieurs portails de données, pour du partage en open data ou en interne ;</li>
<li>Les <strong>connecteurs de catalogues</strong> : se synchroniser avec d'autres catalogues de données, dans les deux sens ;</li>
<li><strong>Data Fair Processings</strong> : programmer des traitements périodiques pour mettre à jour les données et récolter les données issues de l’IOT ;</li>
<li><strong>Notify</strong> : gérer les alertes et les notifications ;</li>
<li>Les <strong>analytics</strong> : peuvent être gérés directement dans la plateforme à l'aide de Matomo ;</li>
<li><strong>Capture</strong> : créer les miniatures et les captures d’images des visualisations ;</li>
<li><strong>Thumbor</strong> : permet les traitement des images des jeux de données ;</li>
<li><strong>Backup</strong> : gérer les sauvegardes de la plateforme ;</li>
<li>Les <strong>services distants</strong> ne sont pas développés dans ce projet : ce sont des applications web développées et déployées de manière autonome qui respectent les règles d’interopérabilité d’OpenAPI 3.0 avec Data Fair. Ils sont disponibles sous forme d'extensions ;</li>
<li>Les <strong>visualisations de données</strong> : certaines sont open source, d'autres propriétaires (extensions en libre accès ou nécessitant un abonnement). Chaque application de base peut être utilisée autant de fois que désiré pour valoriser différents <strong>jeux de données</strong>. Data Fair permet de stocker et éditer les différents paramètres d'une même application de base.</li>
</ul>
<h2 id="architecture-technique-complète">Architecture technique complète</h2>
<p><img src="./images/technical-architecture/architecture.jpg" alt="Catalogue de données"></p>
<h2 id="authentification">Authentification</h2>
<p>Le mécanisme d'authentification utilisé pour sécuriser les API des différents service est le JWT (JSON Web Token). La sécurité repose sur des mécanismes de cryptograhie asymétrique (RSA). La session utilisateur est maintenue côté client, ce qui permet d'avoir un back-end sans état, et donc <em>scalable</em>. Le back-end n'émet pas de JWT : il doit donc être relié à un annuaire <a href="https://koumoul-dev.github.io/simple-directory/">Simple Directory</a> qui en émet. Le lien vers cet annuaire permet de télécharger sa clé publique pour ensuite vérifier que les JWT reçus sont valides.</p>
<h2 id="déploiement">Déploiement</h2>
<p>Les différents services sont livrés avec <a href="https://www.docker.com/">Docker</a>. Nous recommandons de les déployer et de les opérer dans un environnement tel que Kubernetes.</p>
<p>Il est possible de déployer ces différents services à l'aide de Docker Compose également. Cela permet de démarrer plus rapidement et est particulièrement adapté pour un déploiement en local pour tester la plateforme ou développer des extensions pour celle-ci.</p>
<p>Pour plus de détails, vous pouvez consulter la <a href="install/install">documentation d'installation</a>.</p>
<h2 id="licences">Licences</h2>
<p>Les différents services sont <strong>open source</strong>, avec comme licence l'AGPL v3, qui est une licence copyleft : tous ceux mettant le service à disposition d'autres utilisateurs doivent partager les éventuelles améliorations qu'ils y apporteraient. Nous avons choisi de rendre ces services open source pour deux raisons : pour partager des données <strong>open data</strong>, il nous paraît naturel d'utiliser un service open source, et quel que soit le type de données, l'ouverture du code offre des garanties de sécurité et de pérennité qui permet aux organisations de déployer ces services sur leurs propres serveurs en toute sérénité.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="data-fair" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      2 - Data Fair
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>Data Fair permet d'exposer facilement ses données via une API web, contractualisée et documentée, ce qui permet aux développeurs de les réutiliser facilement dans leurs <strong>applications</strong>. De plus les données peuvent être sémantisées, ce qui permet ensuite de les enrichir avec d'autres données sémantisées. Ainsi, des données qui ont une adresse peuvent par exemple être complétées par des coordonnées GPS, ce qui permet ensuite de les afficher sur une carte.</p>
<p>Le coeur de la solution permet</p>
<ul>
<li>d’indexer des données</li>
<li>d’Apifier des données</li>
<li>d’enrichir des données</li>
<li>de partager des données</li>
<li>de configurer les visualisations</li>
<li>de gérer les droits d’accès aux données et aux visualisations (publication)</li>
</ul>
<p>Cette page présente brièvement les langages de programmation, services et outils utilisés pour réaliser ce projet. Pour les développeurs vous pouvez consulter directement le <a href="https://github.com/data-fair/data-fair">README et le code source sur github</a>.</p>
<h2 id="backend">Backend</h2>
<p>Le backend sert l'application cliente (frontend) et l'API. Le frontend est une application Web dynamique avec un rendu côté serveur partiel et un rendu final côté client en Javascript.</p>
<h3 id="persistance">Persistance</h3>
<p>Ce service utilise 3 types de persistance : fichier, base de données et moteur de recherche.</p>
<p>La persistance fichier est utilisée pour stocker les jeux de données des utilisateurs : les fichiers sont stockés tels quels sur le système de fichier et sont ensuite analysés puis indexés.</p>
<p>Les informations sur les jeux de données, les services distants et les configurations d'applications sont stockées dans une base de données <a href="https://www.mongodb.com/fr">MongoDB</a>, qui est une base NoSQL open source orientée documents. Les jeux de données incrémentaux sont également stockés dans cette base.</p>
<p>Les datasets sont indexés dans un moteur de recherche open source <a href="https://www.elastic.co/fr/products/elasticsearch">ElasticSearch</a>. Très performant et puissant il permet de faire des recherches textuelles et des agrégations pour des temps de réponse irréprochables.</p>
<h2 id="front-end">Front end</h2>
<p>L'interface du service est une applications Web (HTML/CSS/JS).</p>
<p>Le framework Javascript utilisé est <a href="https://vuejs.org/">VueJS 2</a> complété principalement par <a href="https://nuxtjs.org/">Nuxt</a> et <a href="https://vuetifyjs.com/en/">Vuetify</a>. Le tout forme un environnement très complet pour développer des interfaces graphiques dynamiques et claires. La documentation sur cet écosystème est bien fournie et de qualité. Ce n'est pas pour rien que VueJS fait partie des projets Github les plus populaires.</p>
<h2 id="code-source">Code source</h2>
<p>Le code du backend est écrit en <a href="https://nodejs.org/en/">NodeJS</a>, en respectant la syntaxe ES7. Le code utilise donc massivement les promesses, cachées derrières des mots clés comme <em>async</em> ou <em>await</em>. Cela permet d'avoir du code clair, concis et facilement compréhensible, tout en étant très performant grâce à une gestion non bloquante des opérations asynchrones.</p>
<p>Un autre aspect de NodeJS est très utilisé dans ce projet : la gestion d'opérations en flux (streams). Cela permet de réaliser des traitements sur des volumes importants sans abuser des ressources de la machine. Ce service demande donc peu de mémoire vive pour fonctionner (mais il en faudra par contre une bonne quantité pour ElasticSearch).</p>
<p>Le serveur web et l'API sont écrits avec le framework <a href="https://expressjs.com/fr/">express 4</a> qui est utilisé dans de nombreux projets Web NodeJS. Les briques fonctionnelles sont séparées dans des <em>router</em> Express, qui permettent par exemple de définir les opérations autour d'un certain concept.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="simple-directory" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      3 - Simple Directory
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>La connexion et la gestion des comptes est assurée par Simple Directory. Il permet de gérer deux types de comptes : les comptes utilisateurs et les comptes organisations.</p>
<h2 id="gestion-de-session-décentralisée">Gestion de session décentralisée</h2>
<p>Le rôle principal de Simple Directory est de permettre aux utilisateurs de s'authentifier sur la plateforme. Cela se fait au moyen de JWT (JSON Web Tokens) qui sont stockés côté clients. Les clients envoient leur JWT à chaque requête HTTP, et chaque service dans l'infrastructure est capable de vérifier qu'un JWT est correct : le jeton est vérifié avec la clé publique mise à leur disposition par Simple Directory.</p>
<h2 id="connection-des-utilisateurs">Connection des utilisateurs</h2>
<p>Les utilisateurs peuvent se connecter avec un mot de passe et une adresse e-mail ou en utilisant un compte externe, tel qu'un compte Gmail, Facebook, Github ou Linkedin, via le protocole <strong>oAuth2</strong>.</p>
<p>D’autres protocoles ou fournisseurs d’identités, tels que LDAP ou SSO, seront bientôt implémentés.</p>
<h2 id="stack-technique">Stack technique</h2>
<p>Le back-end de Simple Directory est écrit en Node.js avec le framework Express.js. La persistance est assurée avec MongoDB. Le front-end est réalisé avec les frameworks Vue.js, Vuetify.js et Nuxt.js. La création et gestion des JWT est assurée grâce à différentes librairies open source.</p>
<p>Il n'y a pour l'instant qu'un mode de distribution qui est Docker, et il est recommandé d'opérer ce service dans un environnement tel que Kubernetes.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="portal" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      4 - Data Fair Portal
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>Data Fair Portal permet de réaliser des portails de données, publics ou privés.</p>
<p>Une organisation peut avoir plusieurs portails, et il sera bientôt possible de réaliser des portails multi-organisations. Chaque portail peut être publié sur un nom de domaine différent, Data Fair Portal agit à la manière d'un <em>reverse proxy</em> pour que chaque requête HTTP soit traitée dans le contexte du portail auquel elle fait référence.</p>
<p>L'authentification avec Simple Directory n'étant possible que sur le même domaine (ou sur un sous-domaine de celui pour lequel Simple Directory est configuré), les portails de données sur un autre domaine ne peuvent être que des portails open data.</p>
<h2 id="stack-technique">Stack technique</h2>
<p>Le back-end de Data Fair Portal est écrit en Node.js avec le framework Express.js. La persistance est assurée avec MongoDB. Le front-end est réalisé avec les frameworks Vue.js, Vuetify.js et Nuxt.js. La configuration des pages est faites à l'aide de JSON schémas interprétés par la librairie VJFS.</p>
<p>Il n'y a pour l'instant qu'un mode de distribution qui est Docker, et il est recommandé d'opérer ce service dans un environnement tel que Kubernetes.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="connectors" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      5 - Connecteurs de catalogues
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>Les connecteurs de catalogues permettent d'interagir avec des catalogues de données, pour moissonner leurs données ou, au contraire, y publier des jeux de données hébergés sur Data Fair. Contrairement aux traitements de données périodiques, les connecteurs de catalogues permettent de synchroniser des ensembles de jeux de données.</p>
<p>Une refonte est en cours concernant ces connecteurs qui devront être réalisés sous la forme d'API Rest respectant un certain contrat spécifié au format OpenAPI 3.1.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="processings" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      6 - Data Fair Processings
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>Data Fair Processings permet de programmer des traitements périodiques. Ils permettent d'aller chercher des données à certains endroits, les transformer et les publier sur Data Fair. Il est aussi prévu de pouvoir faire prochainement l'inverse. Il permet, en pratique, de mettre à jour automatiquement des jeux de données spécifiques.</p>
<h2 id="stack-technique">Stack technique</h2>
<p>Le back-end de Data Fair Processings est écrit en Node.js avec le framework Express.js. La persistance est assurée avec MongoDB. Le front-end est réalisé avec les frameworks Vue.js, Vuetify.js et Nuxt.js. Les plugins pour ajouter de nouveaux types de traitements sont à écrire en Node.js, mais il est prévu dans le futur de pouvoir supporter des plugins écrits dans d'autres langages.</p>
<p>Il n'y a pour l'instant qu'un mode de distribution qui est Docker, et il est recommandé d'opérer ce service dans un environnement tel que Kubernetes.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="notify" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      7 - Notify
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>Le service <strong>Notify</strong> permet de gérer les notifications d'une plateforme. Celles-ci peuvent être transmises dans le navigateur, sur un smartphone ou par e-mail.</p>
<h2 id="stack-technique">Stack technique</h2>
<p>Le back-end de Notify est écrit en Node.js avec le framework Express.js. La persistance est assurée avec MongoDB. Le front-end est réalisé avec les frameworks Vue.js, Vuetify.js et Nuxt.js.</p>
<p>Il n'y a pour l'instant qu'un mode de distribution qui est Docker, et il est recommandé d'opérer ce service dans un environnement tel que Kubernetes.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="analytics" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      8 - Analytics
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>La gestion des analytics et autres statistiques d'utilisation de la plateforme peut se faire de deux manières :</p>
<ul>
<li>à l'aide d'un service en ligne externe à la plateforme, tel que Google Analytics ;</li>
<li>avec un service d'analytics déployé sur la même infrastructure que Data Fair ; dans ce cas nous recommandons le logiciel open source <a href="https://fr.matomo.org/matomo-on-premise/">Matomo</a> (anciennement Piwik).</li>
</ul>
<h3 id="matomo">Matomo</h3>
<p>Matomo est écrit en PHP et nécessite une base de données MySQL, comme par exemple MariaDB. Il est distribué sous forme de conteneurs Docker, et nous recommandons de l'intégrer à la plateforme de cette manière.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="capture" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      9 - Capture
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>Le service Capture permet de créer des images à partir de visualisations web ou des documents PDF à partir de pages web.</p>
<h3 id="stack-technique">Stack technique</h3>
<p>Le backend de Capture est écrit en NodeJS avec le framework ExpressJS. Ce service ne possède pas de persistance ni de frontend. Ce service utilise un navigateur headless pour faire les rendu qui est <a href="https://github.com/puppeteer/puppeteer">Puppeteer</a></p>
<p>Il n'y a pour l'instant qu'un mode de distribution qui est Docker, et il est recommandé d'opérer ce service dans un environnement tel que Kubernetes.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="thumbor" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      10 - Thumbor
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p><a href="https://github.com/thumbor/thumbor">Thumbor</a> est un service qui permet d'effectuer des traitements sur les images, dans le but d'améliorer leur affichage :</p>
<ul>
<li>découpe d'une image (Crop) pour, par exemple, avoir des images ayant une proportion bien définie ;</li>
<li>redimensionnement d'une image pour diminuer sa taille et ainsi gagner en vitesse d'affichage dans le portail ou dans les visualisations.</li>
</ul>
</div></div></div></div><div class="page-break"></div> <h2 id="backup" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      11 - Backup
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>Le service <strong>Backup</strong> permet de sauvegarder les données des différents services de la plateforme dans un format compressé.</p>
<p>Les différentes bases MongoDB, les données de Data Fair et les utilisateurs de Simple Directory sont enregistrés lors d’une sauvegarde.
Il est possible de configurer une sauvegarde périodique ou de déclencher une sauvegarde manuellement.</p>
<h3 id="stack-technique">Stack technique</h3>
<p>Le back-end de Backup est écrit en Node.js avec le framework Express.js. La persistance est assurée avec MongoDB. Le front-end est réalisé avec les frameworks Vue.js, Vuetify.js et Nuxt.js. Étant donné son rôle, il est important d'avoir des volumes très fiables avec ce service.</p>
<p>Il n'y a pour l'instant qu'un mode de distribution qui est Docker, et il est recommandé d'opérer ce service dans un environnement tel que Kubernetes.</p>
</div></div></div></div><div class="page-break"></div> <h2 id="http-log" class="text-h4 mt-6 mb-4 grey--text text--darken-3 section-title">
      12 - Statistiques d'API
      <!----></h2> <div class="container doc-page px-0"><div class="hidden-breadcrumb section-title">
    
  </div> <div class="row"><div class="col"><!----> <!----> <!----> <!----> <div cols="12" style="display:none"><p>HTTP logs permet d'extraire des statistiques d'utilisation des API à partir des logs HTTP de services tels que NGINX. Dans la mesure où Data Fair et les différents services associés utilisent beaucoup les mécanismes de cache pour améliorer les temps d'accès aux ressources, des statistiques précises d'utilisation des différents points d'accès de la plateforme ne peuvent être extraites qu'après coup.</p>
<p>Les logs d'accès aux API sont publiés sur Data Fair sous la forme d'un jeu de données qui peut ensuite être exposé partiellement à des organisations en leur proposant les données filtrées les concernant.</p>
</div></div></div></div></div></div></main></div></div></div></div><script defer src="/4/_nuxt/static/1726145075/full/technical-architecture/state.js"></script><script src="/4/_nuxt/386a0b2.js" defer></script><script src="/4/_nuxt/e5ad1e7.js" defer></script><script src="/4/_nuxt/0f1c295.js" defer></script><script src="/4/_nuxt/77b2d93.js" defer></script><script src="/4/_nuxt/88f996d.js" defer></script><script src="/4/_nuxt/61b5a06.js" defer></script>
  </body>
</html>
